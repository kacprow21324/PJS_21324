{"ast":null,"code":"import _objectSpread from\"C:/Users/Kacper/Desktop/PJS_projekt/projekt_dev/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import'../App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PostThread(_ref){let{post,user,onVoteReply,onReply}=_ref;const[replyText,setReplyText]=useState('');const[activeReplyTo,setActiveReplyTo]=useState(null);// Tu trzymamy stan open/closed dla każdego r.id\nconst[openMap,setOpenMap]=useState({});const toggleOpen=id=>{setOpenMap(m=>_objectSpread(_objectSpread({},m),{},{[id]:m[id]===undefined?false:!m[id]}));};// Pomocnik do top-level i dzieci\nconst topReplies=post.replies.filter(r=>r.parentId==null);const childReplies=id=>post.replies.filter(r=>r.parentId===id);// Komponent pojedynczej odpowiedzi (rekurencyjnie)\nconst ReplyItem=_ref2=>{var _openMap$r$id;let{r,depth=0}=_ref2;const children=childReplies(r.id);// domyślnie open = true, jeśli undefined w mapie\nconst open=(_openMap$r$id=openMap[r.id])!==null&&_openMap$r$id!==void 0?_openMap$r$id:true;// wybór klasy score\nlet cls='reply-score ';if(r.score>0)cls+='positive';else if(r.score<0)cls+='negative';else cls+='neutral';return/*#__PURE__*/_jsxs(\"div\",{className:\"reply\",style:{marginLeft:depth*20},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center'},children:[children.length>0&&/*#__PURE__*/_jsx(\"button\",{className:\"toggle-btn\",onClick:()=>toggleOpen(r.id),\"aria-label\":open?'Zwiń wątek':'Rozwiń wątek',children:open?'⤴️':'⤵️'}),/*#__PURE__*/_jsxs(\"strong\",{children:[r.user,\":\"]}),\"\\xA0\",r.text]}),open&&/*#__PURE__*/_jsxs(\"div\",{style:{margin:'0.25rem 0 0.75rem 1.5rem'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-like\",onClick:()=>onVoteReply(post.id,r.id,'up'),children:\"Lubi\\u0119\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-dislike\",onClick:()=>onVoteReply(post.id,r.id,'down'),children:\"Nie lubi\\u0119\"}),/*#__PURE__*/_jsx(\"span\",{className:cls,style:{margin:'0 1rem'},children:r.score}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:()=>setActiveReplyTo(r.id),children:\"Odpowiedz\"}),activeReplyTo===r.id&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'.5rem'},children:[/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Twoja odpowied\\u017A...\",value:replyText,onChange:e=>setReplyText(e.target.value),style:{width:'100%',minHeight:'3rem'}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:()=>{if(!replyText)return;onReply(post.id,r.id,replyText);setReplyText('');setActiveReplyTo(null);},children:\"Wy\\u015Blij\"})]}),children.map(cr=>/*#__PURE__*/_jsx(ReplyItem,{r:cr,depth:depth+1},cr.id))]})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"post-thread\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Odpowiedzi (\",post.replies.length,\")\"]}),topReplies.map(r=>/*#__PURE__*/_jsx(ReplyItem,{r:r},r.id)),activeReplyTo===null&&/*#__PURE__*/_jsxs(\"div\",{className:\"reply\",style:{marginTop:'1rem'},children:[/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Twoja odpowied\\u017A...\",value:replyText,onChange:e=>setReplyText(e.target.value),style:{width:'100%',minHeight:'3rem'}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:()=>{if(!replyText)return;onReply(post.id,null,replyText);setReplyText('');},children:\"Odpowiedz\"})]})]});}","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","PostThread","_ref","post","user","onVoteReply","onReply","replyText","setReplyText","activeReplyTo","setActiveReplyTo","openMap","setOpenMap","toggleOpen","id","m","_objectSpread","undefined","topReplies","replies","filter","r","parentId","childReplies","ReplyItem","_ref2","_openMap$r$id","depth","children","open","cls","score","className","style","marginLeft","display","alignItems","length","onClick","text","margin","marginTop","placeholder","value","onChange","e","target","width","minHeight","map","cr"],"sources":["C:/Users/Kacper/Desktop/PJS_projekt/projekt_dev/src/components/PostThread.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport '../App.css';\r\n\r\nexport default function PostThread({ post, user, onVoteReply, onReply }) {\r\n  const [replyText, setReplyText]         = useState('');\r\n  const [activeReplyTo, setActiveReplyTo] = useState(null);\r\n\r\n  // Tu trzymamy stan open/closed dla każdego r.id\r\n  const [openMap, setOpenMap] = useState({});\r\n\r\n  const toggleOpen = id => {\r\n    setOpenMap(m => ({\r\n      ...m,\r\n      [id]: m[id] === undefined ? false : !m[id]\r\n    }));\r\n  };\r\n\r\n  // Pomocnik do top-level i dzieci\r\n  const topReplies   = post.replies.filter(r => r.parentId == null);\r\n  const childReplies = id => post.replies.filter(r => r.parentId === id);\r\n\r\n  // Komponent pojedynczej odpowiedzi (rekurencyjnie)\r\n  const ReplyItem = ({ r, depth = 0 }) => {\r\n    const children = childReplies(r.id);\r\n    // domyślnie open = true, jeśli undefined w mapie\r\n    const open = openMap[r.id] ?? true;\r\n\r\n    // wybór klasy score\r\n    let cls = 'reply-score ';\r\n    if (r.score > 0)      cls += 'positive';\r\n    else if (r.score < 0) cls += 'negative';\r\n    else                   cls += 'neutral';\r\n\r\n    return (\r\n      <div className=\"reply\" style={{ marginLeft: depth * 20 }}>\r\n        <div style={{ display: 'flex', alignItems: 'center' }}>\r\n          {children.length > 0 && (\r\n            <button\r\n              className=\"toggle-btn\"\r\n              onClick={() => toggleOpen(r.id)}\r\n              aria-label={open ? 'Zwiń wątek' : 'Rozwiń wątek'}\r\n            >\r\n              {open ? '⤴️' : '⤵️'}\r\n            </button>\r\n          )}\r\n          <strong>{r.user}:</strong>&nbsp;{r.text}\r\n        </div>\r\n\r\n        {open && (\r\n          <div style={{ margin: '0.25rem 0 0.75rem 1.5rem' }}>\r\n            <button className=\"btn-like\" onClick={() => onVoteReply(post.id, r.id, 'up')}>\r\n              Lubię\r\n            </button>\r\n            <button className=\"btn-dislike\" onClick={() => onVoteReply(post.id, r.id, 'down')}>\r\n              Nie lubię\r\n            </button>\r\n            <span className={cls} style={{ margin: '0 1rem' }}>\r\n              {r.score}\r\n            </span>\r\n            <button className=\"btn\" onClick={() => setActiveReplyTo(r.id)}>\r\n              Odpowiedz\r\n            </button>\r\n\r\n            {activeReplyTo === r.id && (\r\n              <div style={{ marginTop: '.5rem' }}>\r\n                <textarea\r\n                  placeholder=\"Twoja odpowiedź...\"\r\n                  value={replyText}\r\n                  onChange={e => setReplyText(e.target.value)}\r\n                  style={{ width: '100%', minHeight: '3rem' }}\r\n                />\r\n                <button\r\n                  className=\"btn\"\r\n                  onClick={() => {\r\n                    if (!replyText) return;\r\n                    onReply(post.id, r.id, replyText);\r\n                    setReplyText('');\r\n                    setActiveReplyTo(null);\r\n                  }}\r\n                >\r\n                  Wyślij\r\n                </button>\r\n              </div>\r\n            )}\r\n\r\n            {children.map(cr => (\r\n              <ReplyItem key={cr.id} r={cr} depth={depth + 1} />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"post-thread\">\r\n      <h4>Odpowiedzi ({post.replies.length})</h4>\r\n\r\n      {topReplies.map(r => (\r\n        <ReplyItem key={r.id} r={r} />\r\n      ))}\r\n\r\n      {/* dolny formularz tylko gdy nie odpowiadamy w wątku */}\r\n      {activeReplyTo === null && (\r\n        <div className=\"reply\" style={{ marginTop: '1rem' }}>\r\n          <textarea\r\n            placeholder=\"Twoja odpowiedź...\"\r\n            value={replyText}\r\n            onChange={e => setReplyText(e.target.value)}\r\n            style={{ width: '100%', minHeight: '3rem' }}\r\n          />\r\n          <button\r\n            className=\"btn\"\r\n            onClick={() => {\r\n              if (!replyText) return;\r\n              onReply(post.id, null, replyText);\r\n              setReplyText('');\r\n            }}\r\n          >\r\n            Odpowiedz\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}